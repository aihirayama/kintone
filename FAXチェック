//ä»Šå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ—ãƒ¬ãƒƒãƒˆã‚·ãƒ¼ãƒˆã®æƒ…å ±ã‚’å–å¾—
var sheet = SpreadsheetApp.getActiveSpreadsheet();

//æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã‚·ãƒ¼ãƒˆã‚’å–å¾—
//var Sheet_1 = sheet.getSheetByName('FAXç®¡ç†ãƒã‚§ãƒƒã‚¯');
var Sheet_1 = sheet.getActiveSheet();//ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚·ãƒ¼ãƒˆã‚’å–å¾—
var last = Sheet_1.getLastRow() -1;//æœ€çµ‚è¡Œ(ãƒ˜ãƒƒãƒ€ãƒ¼åˆ†-1)
if(last < 1){ last = 1}//å…¥åŠ›æ¬„ãŒç©ºç™½ã®å ´åˆã¯lastã«1ã‚’ä»£å…¥
var values = Sheet_1.getRange(2,1,last,12).getValues();//å…¥åŠ›ç¯„å›²å–å¾—  


function check() {    
  //æœªå…¥åŠ›ã§ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã‚‰ã‚¨ãƒ©ãƒ¼
  if(last < 2){
    Browser.msgBox('ç¯„å›²ãŒã‚ã‚Šã¾ã›ã‚“ğŸ˜¿');
    return
  }
  
  //è¡¨ç¤ºå½¢å¼ã‚’ã€Œæ›¸å¼ãªã—ãƒ†ã‚­ã‚¹ãƒˆã€ã«è¨­å®š
  Sheet_1.getRange('A:L').setNumberFormat('@'); 
  
  //å€¤ã‚’1ãƒ¬ã‚³ãƒ¼ãƒ‰ãšã¤åˆ†å‰²ã—ã¦ã„ã
  var records = [];
  var array = Array.prototype.concat.apply([],values);//ã‚·ãƒ¼ãƒˆã®å€¤ã‚’ä¸€æ¬¡å…ƒé…åˆ—ã«ã™ã‚‹
  
  //arrayã®36ç•ªç›®ã«ã€Œè»¢è¨˜æ¸ˆã¿ã€ãŒã‚ã‚Œã°é…åˆ—48å€‹ç›®ã§åˆ†å‰²ã€ãªã‘ã‚Œã°36å€‹ç›®ã§åˆ†å‰²
  for(var i = 0; 0 < array.length; i++){
    if(array.indexOf('è»¢è¨˜æ¸ˆã¿') === 36){
      records.push(array.splice(0,48));
    } else {
      records.push(array.splice(0,36));
    }
  }
  
  //å†…å®¹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹é–¢æ•°
  function tag(i,item) {
    var st = {
      //é …ç›®ï¼šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç•ªå·
      'Id': records[i][0],
      'FAXNo': records[i][12],
      'å—ä¿¡æ—¥æ™‚': records[i][24],
      'é¡§å®¢å': records[i][1],
      'éƒµä¾¿ç•ªå·': records[i][2],
      'ä½æ‰€': records[i][3],
      'Tel': records[i][4],
      'Fax': records[i][16],
      'Email':records[i][28],
      'æ‹…å½“è€…': records[i][5],
      'ç™»éŒ²è€…': records[i][6],
      'æ‹…å½“ã‚ªãƒš': records[i][7],
      'å†…å®¹': records[i][8],
      'CSå¯¾å¿œçŠ¶æ³': records[i][9],
      'å‚™è€ƒ': records[i][10],
      'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰': records[i][11],
      'è»¢è¨˜æ¸ˆã¿': records[i][36],
    }
    return st[item] 
  }
  
  //ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¨­å®šã™ã‚‹    
  var messagebox = '';
  
  for(var a = 0; a < records.length; a++){
    var message = 'â— `[' + tag(a,'å†…å®¹') + ']`' + tag(a,'å—ä¿¡æ—¥æ™‚') + ' *' + tag(a,'é¡§å®¢å') + '*\n' + 'ã€€https://operators.job-medley.com/received_faxes/?utf8=âœ“&idxcnt=' + tag(a,'FAXNo') + '\n';
    var messageitem = '';
    
    switch (tag(a,'å†…å®¹')) {
      case 'æœªé¸æŠ':
        messageitem += '<å†…å®¹>ãŒã€æœªé¸æŠã€‘ã§ã™ã€‚\n';
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;     
        
      case 'CSåéŸ¿':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Tel') === '(Tel)' && tag(a,'å‚™è€ƒ').indexOf('é›»è©±ç•ªå·è¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<Tel>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Fax') === 'fax@medley.jp' && tag(a,'å‚™è€ƒ').indexOf('FAXç•ªå·è¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<FAX>ç•ªå·ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').indexOf('æ‹…å½“è€…åè¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') === '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') === 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'é¢æ¥çµæœ':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') === '(ä¼šå“¡ID)' && tag(a,'å‚™è€ƒ').search(/.*å…±æœ‰æ¸ˆ.*/) < 0){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') === 'æœªå®š'  && tag(a,'å‚™è€ƒ').search(/.*å…±æœ‰æ¸ˆ.*/) < 0){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'å‚™è€ƒ') === '(å‚™è€ƒ)'){messageitem += 'ã€€<å‚™è€ƒ>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'å…¥è·ç¢ºèª':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'å‚™è€ƒ') === '(å‚™è€ƒ)'){messageitem += 'ã€€<å‚™è€ƒ>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'å‚™è€ƒ') !== '(å‚™è€ƒ)' && tag(a,'å‚™è€ƒ').search(/.*å‡ºå‹¤.*|.*å…¥è·.*/) < 0){messageitem += 'ã€€<å‚™è€ƒ>ã«"å…¥è·"ã‚‚ã—ãã¯"å‡ºå‹¤"ã¨ã„ã†è¨˜è¼‰ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'è«‹æ±‚æ›¸':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'JMç”³è¾¼æ›¸':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').indexOf('æ‹…å½“è€…åè¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') === 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}   
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'æ–°è¦æ²è¼‰ä¾é ¼':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Tel') === '(Tel)' && tag(a,'å‚™è€ƒ').indexOf('é›»è©±ç•ªå·è¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<Tel>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Fax') === 'fax@medley.jp' && tag(a,'å‚™è€ƒ').indexOf('FAXç•ªå·è¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<FAX>ç•ªå·ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').indexOf('æ‹…å½“è€…åè¨˜è¼‰ãªã—') < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'ã‚»ãƒ¼ãƒ«ã‚¹åéŸ¿':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Tel') === '(Tel)' && tag(a,'å‚™è€ƒ').search(/.*é›»è©±.*|.*ã€è»¢è¨˜ãªã—ã€‘.*|.*Tel.*|.*tel.*|.*TEL.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<Tel>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Fax') === 'fax@medley.jp' && tag(a,'å‚™è€ƒ').search(/.*FAX.*|.*fax.*|.*Fax.*|.*ãƒ•ã‚¡ãƒƒã‚¯ã‚¹.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<FAX>ç•ªå·ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').search(/.*æ‹…å½“è€….*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') === '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'å‚™è€ƒ').search(/.*ã€è»¢è¨˜ãªã—ã€‘.*/) < 0){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰').indexOf('S') !== 0){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒ"S"ã‹ã‚‰å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰').length !== 8){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒ8æ¡ã§å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'å‚™è€ƒ').search(/.*ã€è»¢è¨˜ãªã—ã€‘.*/) > -1 ){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'} 
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'æ—¢å­˜æ˜èµ·ã—':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'æ±‚äººç¥¨':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'å‚™è€ƒ') === ('(å‚™è€ƒ)')){messageitem += 'ã€€<å‚™è€ƒ>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        else if(tag(a,'å‚™è€ƒ').search(/.*å…±æœ‰æ¸ˆ.*|.*å†é€åˆ†ã‚ã‚Š.*|.*ç¢ºèªæ¸ˆ.*/) < 0){messageitem += 'ã€€<å‚™è€ƒ>ã«â€å…±æœ‰æ¸ˆâ€ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'åŸç¨¿ä¿®æ­£':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š' && tag(a,'å‚™è€ƒ').search(/.*é¡§å®¢å¯¾å¿œã‚·ãƒ¼ãƒˆã«è»¢è¨˜æ¸ˆã¿.*/) < 0){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'å‚™è€ƒ') !== ('(å‚™è€ƒ)') && tag(a,'å‚™è€ƒ').search(/.*é¡§å®¢å¯¾å¿œã‚·ãƒ¼ãƒˆã«è»¢è¨˜æ¸ˆã¿.*/) < 0){messageitem += 'ã€€<å‚™è€ƒ>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'PSåéŸ¿':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Tel') === '(Tel)' && tag(a,'å‚™è€ƒ').search(/.*é›»è©±.*|.*ã€è»¢è¨˜ãªã—ã€‘.*|.*Tel.*|.*tel.*|.*TEL.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<Tel>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Fax') === 'fax@medley.jp' && tag(a,'å‚™è€ƒ').search(/.*FAX.*|.*fax.*|.*Fax.*|.*ãƒ•ã‚¡ãƒƒã‚¯ã‚¹.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<FAX>ç•ªå·ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').search(/.*æ‹…å½“è€….*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') === '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'å‚™è€ƒ').search(/.*ã€è»¢è¨˜ãªã—ã€‘.*/) < 0){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰').indexOf('P') !== 0){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒ"P"ã‹ã‚‰å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰').length !== 8){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒ8æ¡ã§å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚\n'} 
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)' && tag(a,'å‚™è€ƒ').search(/.*ã€è»¢è¨˜ãªã—ã€‘.*/) > -1 ){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'} 
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'ãƒ†ãƒ¬ãƒåéŸ¿':
        if(tag(a,'é¡§å®¢å') === '(é¡§å®¢å)'){messageitem += 'ã€€<é¡§å®¢å>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Tel') === '(Tel)' && tag(a,'å‚™è€ƒ').search(/.*é›»è©±.*|.*ã€è»¢è¨˜ãªã—ã€‘.*|.*Tel.*|.*tel.*|.*TEL.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<Tel>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'Fax') === 'fax@medley.jp' && tag(a,'å‚™è€ƒ').search(/.*FAX.*|.*fax.*|.*Fax.*|.*ãƒ•ã‚¡ãƒƒã‚¯ã‚¹.*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<FAX>ç•ªå·ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'æ‹…å½“è€…') === '(æ‹…å½“è€…)'  && tag(a,'å‚™è€ƒ').search(/.*æ‹…å½“è€….*|.*äº‹æ¥­æ‰€æƒ…å ±è¨˜è¼‰ãªã—.*/) < 0){messageitem += 'ã€€<æ‹…å½“è€…>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'ãã®ä»–':
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'å‚™è€ƒ') === ('(å‚™è€ƒ)')){messageitem += 'ã€€<å‚™è€ƒ>ãŒæœªå…¥åŠ›ã§ã—ãŸã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;
        
      case 'FAXç¦æ­¢é€£çµ¡':
        if(tag(a,'æ‹…å½“è€…') !== '(æ‹…å½“è€…)'){messageitem += 'ã€€<æ‹…å½“è€…>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ç™»éŒ²è€…') !== '(ä¼šå“¡ID)'){messageitem += 'ã€€<ç™»éŒ²è€…>(æ±‚è·è€…ID)ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'æ‹…å½“ã‚ªãƒš') !== 'æœªå®š'){messageitem += 'ã€€<æ‹…å½“ã‚ªãƒš>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'å‚™è€ƒ') !== ('(å‚™è€ƒ)') && tag(a,'å‚™è€ƒ').search(/^CS$|^ã‚»ãƒ¼ãƒ«ã‚¹$|^PS$|^ãã®ä»–$/) < 0){messageitem += 'ã€€<å‚™è€ƒ>ã«"CS,ã‚»ãƒ¼ãƒ«ã‚¹,PS,ãã®ä»–"ä»¥å¤–ã®æ–‡å­—ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        if(tag(a,'ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰') !== '(ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰)'){messageitem += 'ã€€<ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰>ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚\n'}
        
        if(messageitem.length >0){messagebox += message + messageitem +'\n'}
        break;                   
    }    
  }
  
  if(messagebox.length < 1){
    messagebox += '*+â€¥â€¥â€¥â€¥æ¡ˆå†…ï¼šã‚¨ãƒ©ãƒ¼ã¯è¦‹å½“ãŸã‚Šã¾ã›ã‚“ã§ã—ãŸï¼â€¥â€¥â€¥â€¥+*';
  }
  
  sendSlackMessage_(messagebox, webhookUrlf);
  
}
